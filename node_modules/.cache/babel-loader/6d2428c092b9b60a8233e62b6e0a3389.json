{"remainingRequest":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js!/home/steven/workspace/casting-agency-frontend/node_modules/babel-loader/lib/index.js!/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/steven/workspace/casting-agency-frontend/src/components/movies/MovieList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/steven/workspace/casting-agency-frontend/src/components/movies/MovieList.vue","mtime":1654945191054},{"path":"/home/steven/workspace/casting-agency-frontend/babel.config.js","mtime":1652640712513},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js","mtime":1618407608009},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js","mtime":1618407608051},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/babel-loader/lib/index.js","mtime":1650889791270},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1618407608009},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1634219578329}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9ob21lL3N0ZXZlbi93b3Jrc3BhY2UvY2FzdGluZy1hZ2VuY3ktZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5pbmNsdWRlcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pbmNsdWRlcy5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCB7IEFwaVNlcnZpY2UgfSBmcm9tICJAL2FwaSI7CmltcG9ydCB7IExvYWRpbmdBbmltYXRpb24gfSBmcm9tICJAL2NvbXBvbmVudHMvc2hhcmVkIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJNb3ZpZUxpc3QiLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBtb3ZpZURhdGE6IG51bGwsCiAgICAgIGlzTG9hZGluZzogdHJ1ZSwKICAgICAgZXJyb3I6IG51bGwsCiAgICAgIHVuYXV0aG9yaXNlZDogZmFsc2UsCiAgICAgIHBhZ2VzOiBudWxsLAogICAgICBwYWdlOiAxLAogICAgICBtb3ZpZVRvdGFsOiBudWxsCiAgICB9OwogIH0sCiAgY29tcG9uZW50czogewogICAgTG9hZGluZ0FuaW1hdGlvbjogTG9hZGluZ0FuaW1hdGlvbgogIH0sCiAgd2F0Y2g6IHsKICAgIGF1dGhMb2FkaW5nOiBmdW5jdGlvbiBhdXRoTG9hZGluZyh2KSB7CiAgICAgIGlmICghdikgewogICAgICAgIHRoaXMubG9hZE1vdmllcygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgIG5hbWU6ICJhcHBfbG9naW4iCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBwYWdlOiBmdW5jdGlvbiBwYWdlKCkgewogICAgICBjb25zb2xlLmxvZygicGFnZSBjaGFuZ2VkLCBsb2FkIG1vdmllcyIpOwogICAgICB0aGlzLmxvYWRNb3ZpZXMoKTsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBhdXRoTG9hZGluZzogZnVuY3Rpb24gYXV0aExvYWRpbmcoKSB7CiAgICAgIHJldHVybiB0aGlzLiRhdXRoLmxvYWRpbmc7CiAgICB9LAogICAgcGVybWlzc2lvbnM6IGZ1bmN0aW9uIHBlcm1pc3Npb25zKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1siZ2V0UGVybWlzc2lvbnMiXTsKICAgIH0sCiAgICBwYWdlTnVtYmVyczogZnVuY3Rpb24gcGFnZU51bWJlcnMoKSB7CiAgICAgIHZhciBwYWdlcyA9IFtdOwogICAgICB2YXIgcGFnZSA9IDA7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucGFnZXM7IGkrKykgewogICAgICAgIHBhZ2UrKzsKICAgICAgICBwYWdlcy5wdXNoKHBhZ2UpOwogICAgICAgIGNvbnNvbGUubG9nKHBhZ2VzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBhZ2VzOwogICAgfQogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIGlmICghdGhpcy5hdXRoTG9hZGluZykgewogICAgICBjb25zb2xlLmxvZygidXNlciIsIHRoaXMudXNlcik7CiAgICAgIHRoaXMubG9hZE1vdmllcygpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgc2V0UGFnZTogZnVuY3Rpb24gc2V0UGFnZShwYWdlKSB7CiAgICAgIHRoaXMucGFnZSA9IHBhZ2U7CiAgICAgIGNvbnNvbGUubG9nKCJwYWdlIiwgcGFnZSk7CiAgICB9LAogICAgbG9hZE1vdmllczogZnVuY3Rpb24gbG9hZE1vdmllcygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIHJlc3BvbnNlOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzLmlzTG9hZGluZyA9IHRydWU7CgogICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5wZXJtaXNzaW9ucy5pbmNsdWRlcygibGlzdDptb3ZpZXMiKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gQXBpU2VydmljZS5nZXRJbnN0YW5jZSgpLm1vdmllcygpLmdldEFsbChfdGhpcy5wYWdlKTsKCiAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dC5zZW50OwoKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLm1vdmllRGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgICAgICAgIF90aGlzLnBhZ2VzID0gcmVzcG9uc2UucGFnZXM7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBfdGhpcy5lcnJvciA9ICJGYWlsZWQgdG8gbG9hZCBhY3RvcnMiOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgIF90aGlzLnVuYXV0aG9yaXNlZCA9IHRydWU7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIF90aGlzLmlzTG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfQogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsIA;AACA;AACA;EACAA,iBADA;EAEAC,IAFA,kBAEA;IACA;MACAC,eADA;MAEAC,eAFA;MAGAC,WAHA;MAIAC,mBAJA;MAKAC,WALA;MAMAC,OANA;MAOAC;IAPA;EASA,CAZA;EAaAC;IACAC;EADA,CAbA;EAgBAC;IACAC,WADA,uBACAC,CADA,EACA;MACA;QACA;MACA,CAFA,MAEA;QACA;UAAAb;QAAA;MACA;IACA,CAPA;IAQAO,IARA,kBAQA;MACAO;MACA;IACA;EAXA,CAhBA;EA6BAC;IACAH,WADA,yBACA;MACA;IACA,CAHA;IAIAI,WAJA,yBAIA;MACA;IACA,CANA;IAOAC,WAPA,yBAOA;MACA;MACA;;MACA;QACAV;QACAD;QACAQ;MACA;;MACA;IACA;EAhBA,CA7BA;EA+CAI,OA/CA,qBA+CA;IACA;MACAJ;MACA;IACA;EACA,CApDA;EAqDAK;IACAC,OADA,mBACAb,IADA,EACA;MACA;MACAO;IACA,CAJA;IAKAO,UALA,wBAKA;MAAA;;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;;gBADA,KAEA,yCAFA;kBAAA;kBAAA;gBAAA;;gBAAA;gBAAA,OAGAC,yBACAC,MADA,GAEAC,MAFA,CAEA,UAFA,CAHA;;cAAA;gBAGAC,QAHA;;gBAMA;kBACA;kBACA;gBACA,CAHA,MAGA;kBACA;gBACA;;gBAXA;gBAAA;;cAAA;gBAaA;;cAbA;gBAeA;;cAfA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAgBA;EArBA;AArDA","names":["name","data","movieData","isLoading","error","unauthorised","pages","page","movieTotal","components","LoadingAnimation","watch","authLoading","v","console","computed","permissions","pageNumbers","created","methods","setPage","loadMovies","ApiService","movies","getAll","response"],"sourceRoot":"src/components/movies","sources":["MovieList.vue"],"sourcesContent":["<template>\n  <div class=\"\">\n    <div class=\"d-flex align-items-center py-4 border-bottom\">\n      <h3 class=\"mb-0 me-4\">Movies</h3>\n      <router-link\n        v-if=\"permissions.includes('add:movie')\"\n        tag=\"button\"\n        :to=\"{ name: 'app_movies_new' }\"\n        class=\"btn btn-primary ms-auto\"\n      >\n        <i class=\"bi bi-plus-circle me-1\"></i>\n        <span>Add Movie</span>\n      </router-link>\n    </div>\n\n    <div class=\"mt-2\">\n      <template v-if=\"isLoading\">\n        <LoadingAnimation />\n      </template>\n      <template v-else-if=\"unauthorised\">\n        <p>You do not have permission to view Movies</p>\n      </template>\n      <template v-else-if=\"error\">\n        <p>{{ error }}</p>\n      </template>\n      <template v-else-if=\"!movieData.length\">\n        <p>Could not find any movies.</p>\n      </template>\n      <template v-else>\n        <div class=\"row d-flex px-2 py-3 movie-row align-items-stretch\">\n          <template v-for=\"movie in movieData\">\n            <router-link\n              class=\"movie-card text-decoration-none text-black p-0\"\n              :key=\"movie.id\"\n              :to=\"{ name: 'app_movies_view', params: { id: movie.id } }\"\n            >\n              <div class=\"card shadow-sm p-0\">\n                <div\n                  class=\"card-body movie-card-picture\"\n                  :style=\"{\n                    background: movie.image\n                      ? `url(${movie.image})`\n                      : `url('https://via.placeholder.com/300x250')`,\n                  }\"\n                >\n                  <span class=\"movie-card-link\">\n                    <router-link\n                      v-if=\"permissions.includes('edit:movie')\"\n                      class=\"btn-secondary btn btn-sm py-1 px-3\"\n                      :key=\"movie.id\"\n                      :to=\"{\n                        name: 'app_movies_edit',\n                        params: { id: movie.id },\n                      }\"\n                    >\n                      Edit\n                    </router-link>\n                  </span>\n                  <span class=\"movie-card-link center\">\n                    <button class=\"btn btn-light\">View</button>\n                  </span>\n                </div>\n                <div class=\"card-footer\">\n                  <div class=\"d-flex\">\n                    <h4\n                      class=\"fw-bold movie-title fs-5 text-black text-decoration-none\"\n                    >\n                      {{ movie.title }}\n                    </h4>\n                    <p class=\"ms-auto text-secondary\">\n                      <i class=\"bi bi-people-fill\"></i>\n                      {{ movie.cast ? movie.cast.length : 0 }}\n                    </p>\n                  </div>\n                  <div>\n                    <span class=\"text-secondary fst-italic\">\n                      Releasing:\n                      <span>{{ movie.release_date }}</span>\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </router-link>\n          </template>\n        </div>\n        <div>\n          <nav aria-label=\"Page Navigation\" class=\"mt-4\">\n            <ul class=\"pagination\">\n              <li class=\"page-item\">\n                <a\n                  class=\"page-link\"\n                  @click=\"setPage(page - 1)\"\n                  :class=\"{ disabled: page <= 1 }\"\n                  href=\"#\"\n                  aria-label=\"Previous\"\n                >\n                  <span aria-hidden=\"true\">\n                    <i class=\"bi bi-arrow-left\"></i>\n                  </span>\n                </a>\n              </li>\n              <template v-for=\"(pageNumber, index) in pageNumbers\">\n                <li :key=\"index\" class=\"page-item\">\n                  <a\n                    @click=\"setPage(pageNumber)\"\n                    class=\"page-link\"\n                    :class=\"{ active: page === pageNumber }\"\n                    href=\"#\"\n                  >\n                    {{ pageNumber }}\n                  </a>\n                </li>\n              </template>\n              <li class=\"page-item\">\n                <a\n                  class=\"page-link\"\n                  @click=\"setPage(page + 1)\"\n                  :class=\"{ disabled: page >= pages }\"\n                  href=\"#\"\n                  aria-label=\"Next\"\n                >\n                  <span aria-hidden=\"true\">\n                    <i class=\"bi bi-arrow-right\"></i>\n                  </span>\n                </a>\n              </li>\n            </ul>\n          </nav>\n        </div>\n      </template>\n    </div>\n  </div>\n</template>\n<script>\nimport { ApiService } from \"@/api\";\nimport { LoadingAnimation } from \"@/components/shared\";\nexport default {\n  name: \"MovieList\",\n  data() {\n    return {\n      movieData: null,\n      isLoading: true,\n      error: null,\n      unauthorised: false,\n      pages: null,\n      page: 1,\n      movieTotal: null,\n    };\n  },\n  components: {\n    LoadingAnimation,\n  },\n  watch: {\n    authLoading(v) {\n      if (!v) {\n        this.loadMovies();\n      } else {\n        this.$router.push({ name: \"app_login\" });\n      }\n    },\n    page() {\n      console.log(\"page changed, load movies\");\n      this.loadMovies();\n    },\n  },\n  computed: {\n    authLoading() {\n      return this.$auth.loading;\n    },\n    permissions() {\n      return this.$store.getters[\"getPermissions\"];\n    },\n    pageNumbers() {\n      const pages = [];\n      let page = 0;\n      for (let i = 0; i < this.pages; i++) {\n        page++;\n        pages.push(page);\n        console.log(pages);\n      }\n      return pages;\n    },\n  },\n  created() {\n    if (!this.authLoading) {\n      console.log(\"user\", this.user);\n      this.loadMovies();\n    }\n  },\n  methods: {\n    setPage(page) {\n      this.page = page;\n      console.log(\"page\", page);\n    },\n    async loadMovies() {\n      this.isLoading = true;\n      if (this.permissions.includes(\"list:movies\")) {\n        const response = await ApiService.getInstance()\n          .movies()\n          .getAll(this.page);\n        if (response.success) {\n          this.movieData = response.data;\n          this.pages = response.pages;\n        } else {\n          this.error = \"Failed to load actors\";\n        }\n      } else {\n        this.unauthorised = true;\n      }\n      this.isLoading = false;\n    },\n  },\n};\n</script>\n"]}]}