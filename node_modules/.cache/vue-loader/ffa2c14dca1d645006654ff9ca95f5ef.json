{"remainingRequest":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/steven/workspace/casting-agency-frontend/src/components/security/Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/steven/workspace/casting-agency-frontend/src/components/security/Login.vue","mtime":1652904444453},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js","mtime":1618407608009},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/babel-loader/lib/index.js","mtime":1650889791270},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1618407608009},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1634219578329}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTG9naW4iLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhY2Nlc3NUb2tlbjogbnVsbCwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgaXNBdXRoZW50aWNhdGVkKCkgewogICAgICByZXR1cm4gdGhpcy4kYXV0aC5pc0F1dGhlbnRpY2F0ZWQ7CiAgICB9LAogIH0sCiAgd2F0Y2g6IHsKICAgIGlzQXV0aGVudGljYXRlZDogewogICAgICBhc3luYyBoYW5kbGVyKHZhbCkgewogICAgICAgIGlmICh2YWwpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJhdXRoZW50aWNhdGVkIGNoYW5nZWQiKTsKICAgICAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgdGhpcy4kYXV0aC5nZXRUb2tlblNpbGVudGx5KCk7CiAgICAgICAgICBjb25zdCB1c2VyID0gdGhpcy4kYXV0aC51c2VyOwogICAgICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IHRva2VuOwogICAgICAgICAgY29uc29sZS5sb2coInRva2VuIiwgdG9rZW4pOwogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImp3dCIsIHRva2VuKTsKICAgICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJzZXRBY2Nlc3NUb2tlbiIsIHRva2VuKTsKICAgICAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJzZXRBdXRoVXNlciIsIHVzZXIpOwogICAgICAgICAgY29uc3QgcmVsb2FkZWRQYXRoID0gdGhpcy4kc3RvcmUuZ2V0dGVyc1siZ2V0UmVsb2FkZWRQYXRoIl07CiAgICAgICAgICBjb25zb2xlLmxvZygpOwogICAgICAgICAgaWYgKHRoaXMuJHN0b3JlLmdldHRlcnNbImdldElzUmVsb2FkZWQiXSAmJiByZWxvYWRlZFBhdGggIT09ICIvIikgewogICAgICAgICAgICBjb25zb2xlLmxvZygiY291bnRzIGFzIHJlbG9hZCIpOwogICAgICAgICAgICBhd2FpdCB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6IHJlbG9hZGVkUGF0aCB9KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGF3YWl0IHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogImFwcF9kYXNoYm9hcmQiIH0pOwogICAgICAgICAgfQogICAgICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInNldElzUmVsb2FkZWQiLCBmYWxzZSk7CiAgICAgICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgic2V0UmVsb2FkZWRQYXRoIiwgbnVsbCk7CiAgICAgICAgfQogICAgICB9LAogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIExvZyB0aGUgdXNlciBpbgogICAgYXN5bmMgbG9naW4oKSB7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJqd3QiLCAidGVzdCIpOwogICAgICBhd2FpdCB0aGlzLiRhdXRoLmxvZ2luV2l0aFBvcHVwKCk7CiAgICAgIGF3YWl0IHRoaXMuZ2V0VG9rZW4oKTsKICAgIH0sCiAgICBhc3luYyBnZXRUb2tlbigpIHsKICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCB0aGlzLiRhdXRoLmdldFRva2VuU2lsZW50bHkoKTsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImp3dCIsIHRoaXMudG9rZW4pOwogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgic2V0QWNjZXNzVG9rZW4iLCB0b2tlbik7CiAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSB0b2tlbjsKICAgICAgYXdhaXQgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAiYXBwX2Rhc2hib2FyZCIgfSk7CiAgICB9LAogICAgLy8gTG9nIHRoZSB1c2VyIG91dAogICAgbG9nb3V0KCkgewogICAgICB0aGlzLiRhdXRoLmxvZ291dCh7CiAgICAgICAgcmV0dXJuVG86IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sCiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIGNhbGxBcGkoKSB7CiAgICAgIC8vIEdldCB0aGUgYWNjZXNzIHRva2VuIGZyb20gdGhlIGF1dGggd3JhcHBlcgogICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IHRoaXMuJGF1dGguZ2V0VG9rZW5TaWxlbnRseSgpOwoKICAgICAgLy8gLy8gVXNlIEF4aW9zIHRvIG1ha2UgYSBjYWxsIHRvIHRoZSBBUEkKICAgICAgLy8gY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBheGlvcy5nZXQoZG9tYWluLCB7CiAgICAgIC8vICAgaGVhZGVyczogewogICAgICAvLyAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciA8JT0gIiR7dG9rZW59IiAlPmAsIC8vIHNlbmQgdGhlIGFjY2VzcyB0b2tlbiB0aHJvdWdoIHRoZSAnQXV0aG9yaXphdGlvbicgaGVhZGVyCiAgICAgIC8vICAgfSwKICAgICAgLy8gfSk7CgogICAgICBjb25zb2xlLmxvZyh0b2tlbik7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/components/security","sourcesContent":["<template>\n  <section\n    class=\"h-100 w-100 position-absolute bg-light\"\n    style=\"left: 0; top: 0\"\n  >\n    <div class=\"h-100 w-100 d-flex justify-content-center align-items-center\">\n      <div class=\"card p-4 shadow-sm\">\n        <div\n          class=\"card-body d-flex align-items-center justify-content-center flex-column\"\n        >\n          <h2 class=\"fs-3\">Casting Agency Login</h2>\n          <div v-if=\"!$auth.loading\">\n            <p\n              v-if=\"!$auth.isAuthenticated\"\n              class=\"text-secondary text-center\"\n              style=\"font-size: 13px\"\n            >\n              Please click the button below to login\n            </p>\n            <p\n              v-if=\"$auth.isAuthenticated\"\n              class=\"text-secondary text-center\"\n              style=\"font-size: 13px\"\n            >\n              You are logged in! <br />\n              Click the button below to logout.\n            </p>\n          </div>\n          <div>\n            <!-- show login when not authenticated -->\n            <div class=\"w-100 d-flex justify-content-center\">\n              <button\n                class=\"btn btn-lg btn-primary mt-4\"\n                v-if=\"!$auth.isAuthenticated\"\n                @click=\"login\"\n                :disabled=\"$auth.loading\"\n              >\n                <span v-if=\"!$auth.loading\">Log in</span>\n                <span v-if=\"$auth.loading\">\n                  Authenticating\n                  <span\n                    class=\"spinner-border text-white\"\n                    style=\"width: 1.2rem; height: 1.2rem\"\n                    role=\"status\"\n                  ></span>\n                </span>\n              </button>\n              <!-- show logout when authenticated -->\n              <button\n                class=\"btn btn-lg btn-primary mt-4\"\n                v-if=\"$auth.isAuthenticated\"\n                @click=\"logout\"\n              >\n                Log out\n              </button>\n            </div>\n\n            <div\n              v-if=\"$auth.isAuthenticated\"\n              class=\"w-100 d-flex justify-content-center\"\n            >\n              <button\n                class=\"btn btn-sm btn-outline-secondary mt-4\"\n                @click=\"getToken\"\n                :disabled=\"accessToken\"\n              >\n                <span v-if=\"accessToken\">Token Saved!</span>\n                <span v-else>Get Token</span>\n              </button>\n            </div>\n          </div>\n          <div v-if=\"$auth.error\">\n            {{ $auth.error }}\n          </div>\n          <!--          <div class=\"text-center mt-3\" style=\"max-width: 300px\">-->\n          <!--            <pre>-->\n          <!--              <code>{{ token }}</code>-->\n          <!--            </pre>-->\n          <!--          </div>-->\n        </div>\n      </div>\n    </div>\n  </section>\n</template>\n<script>\nexport default {\n  name: \"Login\",\n  data() {\n    return {\n      accessToken: null,\n    };\n  },\n  computed: {\n    isAuthenticated() {\n      return this.$auth.isAuthenticated;\n    },\n  },\n  watch: {\n    isAuthenticated: {\n      async handler(val) {\n        if (val) {\n          console.log(\"authenticated changed\");\n          const token = await this.$auth.getTokenSilently();\n          const user = this.$auth.user;\n          this.accessToken = token;\n          console.log(\"token\", token);\n          localStorage.setItem(\"jwt\", token);\n          await this.$store.dispatch(\"setAccessToken\", token);\n          await this.$store.dispatch(\"setAuthUser\", user);\n          const reloadedPath = this.$store.getters[\"getReloadedPath\"];\n          console.log();\n          if (this.$store.getters[\"getIsReloaded\"] && reloadedPath !== \"/\") {\n            console.log(\"counts as reload\");\n            await this.$router.push({ path: reloadedPath });\n          } else {\n            await this.$router.push({ name: \"app_dashboard\" });\n          }\n          await this.$store.dispatch(\"setIsReloaded\", false);\n          await this.$store.dispatch(\"setReloadedPath\", null);\n        }\n      },\n    },\n  },\n  methods: {\n    // Log the user in\n    async login() {\n      localStorage.setItem(\"jwt\", \"test\");\n      await this.$auth.loginWithPopup();\n      await this.getToken();\n    },\n    async getToken() {\n      const token = await this.$auth.getTokenSilently();\n      localStorage.setItem(\"jwt\", this.token);\n      await this.$store.dispatch(\"setAccessToken\", token);\n      this.accessToken = token;\n      await this.$router.push({ name: \"app_dashboard\" });\n    },\n    // Log the user out\n    logout() {\n      this.$auth.logout({\n        returnTo: window.location.origin,\n      });\n    },\n    async callApi() {\n      // Get the access token from the auth wrapper\n      const token = await this.$auth.getTokenSilently();\n\n      // // Use Axios to make a call to the API\n      // const { data } = await axios.get(domain, {\n      //   headers: {\n      //     Authorization: `Bearer <%= \"${token}\" %>`, // send the access token through the 'Authorization' header\n      //   },\n      // });\n\n      console.log(token);\n    },\n  },\n};\n</script>\n"]}]}