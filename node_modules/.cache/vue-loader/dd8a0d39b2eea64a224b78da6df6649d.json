{"remainingRequest":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/steven/workspace/casting-agency-frontend/src/components/movies/MovieSingle.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/steven/workspace/casting-agency-frontend/src/components/movies/MovieSingle.vue","mtime":1652735899682},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js","mtime":1618407608009},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/babel-loader/lib/index.js","mtime":1650889791270},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1618407608009},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1634219578329}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IEJGb3JtLCBCRm9ybUlucHV0LCBCRm9ybVNlbGVjdCwgQkZvcm1EYXRlcGlja2VyIH0gZnJvbSAiYm9vdHN0cmFwLXZ1ZSI7CmltcG9ydCB7IEFwaVNlcnZpY2UgfSBmcm9tICJAL2FwaSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIk1vdmllU2luZ2xlIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbW92aWVEYXRhOiBudWxsLAogICAgICBhY3RvcnM6IFtdLAogICAgICBpc0xvYWRpbmc6IHRydWUsCiAgICAgIGVycm9yOiBudWxsLAogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICBpZiAodGhpcy4kcm91dGUubmFtZS5zdGFydHNXaXRoKCJhcHBfbW92aWVzX25ldyIpKSB7CiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICAgIHRoaXMubW92aWVEYXRhID0gewogICAgICAgIHRpdGxlOiBudWxsLAogICAgICAgIHJlbGVhc2VEYXRlOiBudWxsLAogICAgICAgIGFjdG9yczogW10sCiAgICAgIH07CiAgICB9CgogICAgdGhpcy5pbml0aWFsaXNlTW92aWVGb3JtKCk7CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBCRm9ybSwKICAgIEJGb3JtSW5wdXQsCiAgICBCRm9ybVNlbGVjdCwKICAgIEJGb3JtRGF0ZXBpY2tlciwKICB9LAogIGNvbXB1dGVkOiB7CiAgICBwYWdlVGl0bGUoKSB7CiAgICAgIHJldHVybiB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQKICAgICAgICA/ICJFZGl0ICIgKyB0aGlzLm1vdmllRGF0YS5uYW1lCiAgICAgICAgOiAiTmV3IE1vdmllIjsKICAgIH0sCiAgICBzdWJtaXRUZXh0KCkgewogICAgICBsZXQgYnV0dG9uVGV4dDsKICAgICAgc3dpdGNoICh0aGlzLiRyb3V0ZS5uYW1lKSB7CiAgICAgICAgY2FzZSAiYXBwX21vdmllc19uZXciOgogICAgICAgICAgdGhpcy5zYXZpbmcKICAgICAgICAgICAgPyAoYnV0dG9uVGV4dCA9ICJBZGRpbmcgTW92aWUiKQogICAgICAgICAgICA6IChidXR0b25UZXh0ID0gIlNhdmUgTW92aWUiKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgImFwcF9tb3ZpZXNfZWRpdCI6CiAgICAgICAgICB0aGlzLnNhdmluZwogICAgICAgICAgICA/IChidXR0b25UZXh0ID0gIlVwZGF0aW5nIE1vdmllIikKICAgICAgICAgICAgOiAoYnV0dG9uVGV4dCA9ICJVcGRhdGUgTW92aWUiKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIHJldHVybiBidXR0b25UZXh0OwogICAgfSwKICB9LAogIG1ldGhvZHM6IHsKICAgIGluaXRpYWxpc2VNb3ZpZUZvcm0oKSB7CiAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTsKICAgICAgaWYgKHRoaXMuJHJvdXRlLm5hbWUuc3RhcnRzV2l0aCgiYXBwX21vdmllc19uZXciKSkgewogICAgICAgIHRoaXMubG9hZE1vdmllKCk7CiAgICAgIH0KICAgICAgdGhpcy5sb2FkQWN0b3JzKCk7CiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICB9LAogICAgYXN5bmMgbG9hZEFjdG9ycygpIHsKICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBBcGlTZXJ2aWNlLmdldEluc3RhbmNlKCkuYWN0b3JzKCkuZ2V0QWxsKC0xKTsKICAgICAgaWYgKHJlc3BvbnNlLnN1Y2Nlc3MpIHsKICAgICAgICBjb25zdCBhY3RvcnMgPSByZXNwb25zZS5kYXRhOwogICAgICAgIGFjdG9ycy5mb3JFYWNoKChhY3RvcikgPT4gewogICAgICAgICAgY29uc3QgYWN0b3JPYmplY3QgPSB7IHRleHQ6IGFjdG9yLm5hbWUsIHZhbHVlOiBhY3Rvci5pZCB9OwogICAgICAgICAgdGhpcy5hY3RvcnMucHVzaChhY3Rvck9iamVjdCk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lcnJvciA9ICJGYWlsZWQgdG8gbG9hZCBhY3RvcnMiOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgbG9hZE1vdmllKCkgewogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IEFwaVNlcnZpY2UuZ2V0SW5zdGFuY2UoKQogICAgICAgIC5hY3RvcnMoKQogICAgICAgIC5nZXQodGhpcy4kcm91dGUucGFyYW1zLmlkKTsKICAgICAgaWYgKHJlc3BvbnNlLnN1Y2Nlc3MpIHsKICAgICAgICB0aGlzLm1vdmllRGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lcnJvciA9ICJGYWlsZWQgdG8gbG9hZCBhY3RvciI7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBzYXZlTW92aWUoKSB7CiAgICAgIHRoaXMuc2F2aW5nID0gdHJ1ZTsKCiAgICAgIGxldCByZXNwb25zZTsKCiAgICAgIGlmICh0aGlzLiRyb3V0ZS5wYXJhbXMuaWQpIHsKICAgICAgICByZXNwb25zZSA9IGF3YWl0IEFwaVNlcnZpY2UuZ2V0SW5zdGFuY2UoKQogICAgICAgICAgLmFjdG9ycygpCiAgICAgICAgICAudXBkYXRlKHRoaXMuJHJvdXRlLnBhcmFtcywgdGhpcy5tb3ZpZURhdGEpOwogICAgICB9IGVsc2UgewogICAgICAgIHJlc3BvbnNlID0gYXdhaXQgQXBpU2VydmljZS5nZXRJbnN0YW5jZSgpCiAgICAgICAgICAuYWN0b3JzKCkKICAgICAgICAgIC5jcmVhdGUodGhpcy5tb3ZpZURhdGEpOwogICAgICB9CgogICAgICBpZiAocmVzcG9uc2Uuc3VjY2VzcykgewogICAgICAgIGF3YWl0IHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogImFwcF9hY3RvcnNfbGlzdCIgfSk7CiAgICAgICAgdGhpcy5lcnJvciA9IG51bGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHRoaXMuJHJvdXRlLnBhcmFtcy5pZCkgewogICAgICAgICAgdGhpcy5lcnJvciA9ICJFcnJvciB3aGVuIHVwZGF0aW5nIGFjdG9yIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lcnJvciA9ICJFcnJvciB3aGVuIHNhdmluZyBhY3RvciI7CiAgICAgICAgfQogICAgICB9CgogICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICB0aGlzLnNhdmluZyA9IGZhbHNlOwogICAgICB9LCAyMDAwKTsKICAgIH0sCiAgfSwKfTsK"},{"version":3,"sources":["MovieSingle.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"MovieSingle.vue","sourceRoot":"src/components/movies","sourcesContent":["<template>\n  <div>\n    <div class=\"d-flex align-items-center py-4 border-bottom\">\n      <h3 class=\"mb-0 me-4\">{{ pageTitle }}</h3>\n    </div>\n    <div class=\"mt-2\">\n      <div class=\"alert alert-warning\" v-if=\"error\">\n        {{ error }}\n      </div>\n      <BForm>\n        <div class=\"row\">\n          <div class=\"col col-auto\">\n            <BFormInput\n              v-model=\"movieData.title\"\n              placeholder=\"Movie Title\"\n            ></BFormInput>\n          </div>\n          <div class=\"col col-auto\">\n            <BFormDatepicker\n              class=\"form-control\"\n              v-model=\"movieData.releaseDate\"\n            ></BFormDatepicker>\n          </div>\n          <div class=\"col col-auto\">\n            <BFormSelect\n              class=\"form-select\"\n              v-model=\"movieData.actors\"\n              :options=\"actors\"\n            />\n          </div>\n        </div>\n\n        <button class=\"btn btn-primary mt-3\" @click.prevent=\"saveMovie\">\n          <span>{{ submitText }}</span>\n        </button>\n      </BForm>\n    </div>\n  </div>\n</template>\n<script>\nimport { BForm, BFormInput, BFormSelect, BFormDatepicker } from \"bootstrap-vue\";\nimport { ApiService } from \"@/api\";\n\nexport default {\n  name: \"MovieSingle\",\n  data() {\n    return {\n      movieData: null,\n      actors: [],\n      isLoading: true,\n      error: null,\n    };\n  },\n  created() {\n    if (this.$route.name.startsWith(\"app_movies_new\")) {\n      this.isLoading = false;\n      this.movieData = {\n        title: null,\n        releaseDate: null,\n        actors: [],\n      };\n    }\n\n    this.initialiseMovieForm();\n  },\n  components: {\n    BForm,\n    BFormInput,\n    BFormSelect,\n    BFormDatepicker,\n  },\n  computed: {\n    pageTitle() {\n      return this.$route.params.id\n        ? \"Edit \" + this.movieData.name\n        : \"New Movie\";\n    },\n    submitText() {\n      let buttonText;\n      switch (this.$route.name) {\n        case \"app_movies_new\":\n          this.saving\n            ? (buttonText = \"Adding Movie\")\n            : (buttonText = \"Save Movie\");\n          break;\n        case \"app_movies_edit\":\n          this.saving\n            ? (buttonText = \"Updating Movie\")\n            : (buttonText = \"Update Movie\");\n          break;\n      }\n      return buttonText;\n    },\n  },\n  methods: {\n    initialiseMovieForm() {\n      this.isLoading = true;\n      if (this.$route.name.startsWith(\"app_movies_new\")) {\n        this.loadMovie();\n      }\n      this.loadActors();\n      this.isLoading = false;\n    },\n    async loadActors() {\n      const response = await ApiService.getInstance().actors().getAll(-1);\n      if (response.success) {\n        const actors = response.data;\n        actors.forEach((actor) => {\n          const actorObject = { text: actor.name, value: actor.id };\n          this.actors.push(actorObject);\n        });\n      } else {\n        this.error = \"Failed to load actors\";\n      }\n    },\n    async loadMovie() {\n      const response = await ApiService.getInstance()\n        .actors()\n        .get(this.$route.params.id);\n      if (response.success) {\n        this.movieData = response.data;\n      } else {\n        this.error = \"Failed to load actor\";\n      }\n    },\n    async saveMovie() {\n      this.saving = true;\n\n      let response;\n\n      if (this.$route.params.id) {\n        response = await ApiService.getInstance()\n          .actors()\n          .update(this.$route.params, this.movieData);\n      } else {\n        response = await ApiService.getInstance()\n          .actors()\n          .create(this.movieData);\n      }\n\n      if (response.success) {\n        await this.$router.push({ name: \"app_actors_list\" });\n        this.error = null;\n      } else {\n        if (this.$route.params.id) {\n          this.error = \"Error when updating actor\";\n        } else {\n          this.error = \"Error when saving actor\";\n        }\n      }\n\n      setTimeout(() => {\n        this.saving = false;\n      }, 2000);\n    },\n  },\n};\n</script>\n"]}]}