{"remainingRequest":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/steven/workspace/casting-agency-frontend/src/components/Dashboard.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/steven/workspace/casting-agency-frontend/src/components/Dashboard.vue","mtime":1654090730469},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js","mtime":1618407608009},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-plugin-babel/node_modules/thread-loader/dist/cjs.js","mtime":1618407608051},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/babel-loader/lib/index.js","mtime":1650889791270},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1618407608009},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1634219578329}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IEJhc2VQYWdlIH0gZnJvbSAiQC9jb21wb25lbnRzIjsKaW1wb3J0IHsgTG9hZGluZ0FuaW1hdGlvbiB9IGZyb20gIkAvY29tcG9uZW50cy9zaGFyZWQiOwppbXBvcnQgeyBBcGlTZXJ2aWNlIH0gZnJvbSAiQC9hcGkiOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJEYXNoYm9hcmQiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBtb3ZpZURhdGE6IG51bGwsCiAgICAgIG1vdmllVG90YWw6IG51bGwsCiAgICAgIGFjdG9yRGF0YTogbnVsbCwKICAgICAgYWN0b3JUb3RhbDogbnVsbCwKICAgICAgaXNMb2FkaW5nOiB7CiAgICAgICAgYWN0b3JzOiB0cnVlLAogICAgICAgIG1vdmllczogdHJ1ZSwKICAgICAgfSwKICAgICAgZXJyb3I6IHsKICAgICAgICBhY3RvcnM6IG51bGwsCiAgICAgICAgbW92aWVzOiBudWxsLAogICAgICB9LAogICAgICB1bmF1dGhvcmlzZWQ6IGZhbHNlLAogICAgfTsKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIEJhc2VQYWdlLAogICAgTG9hZGluZ0FuaW1hdGlvbiwKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxvYWRBY3RvcnMoKTsKICAgIHRoaXMubG9hZE1vdmllcygpOwogIH0sCiAgd2F0Y2g6IHsKICAgIGF1dGhMb2FkaW5nKHYpIHsKICAgICAgaWYgKCF2KSB7CiAgICAgICAgdGhpcy5sb2FkTW92aWVzKCk7CiAgICAgICAgdGhpcy5sb2FkQWN0b3JzKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAiYXBwX2xvZ2luIiB9KTsKICAgICAgfQogICAgfSwKICB9LAogIGNvbXB1dGVkOiB7CiAgICBhdXRoTG9hZGluZygpIHsKICAgICAgcmV0dXJuIHRoaXMuJGF1dGgubG9hZGluZzsKICAgIH0sCiAgICBwZXJtaXNzaW9ucygpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnNbImdldFBlcm1pc3Npb25zIl07CiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgbG9hZEFjdG9ycygpIHsKICAgICAgdGhpcy5pc0xvYWRpbmcuYWN0b3JzID0gdHJ1ZTsKICAgICAgaWYgKHRoaXMucGVybWlzc2lvbnMuaW5jbHVkZXMoImxpc3Q6YWN0b3JzIikpIHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IEFwaVNlcnZpY2UuZ2V0SW5zdGFuY2UoKQogICAgICAgICAgLmFjdG9ycygpCiAgICAgICAgICAuZ2V0QWxsKDEsICJieV9jYXN0aW5ncyIpOwogICAgICAgIGlmIChyZXNwb25zZS5zdWNjZXNzKSB7CiAgICAgICAgICB0aGlzLmFjdG9yRGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICB0aGlzLmFjdG9yVG90YWwgPSByZXNwb25zZS50b3RhbDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lcnJvci5hY3RvcnMgPSAiRmFpbGVkIHRvIGxvYWQgYWN0b3JzIjsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy51bmF1dGhvcmlzZWQgPSB0cnVlOwogICAgICB9CiAgICAgIHRoaXMuaXNMb2FkaW5nLmFjdG9ycyA9IGZhbHNlOwogICAgfSwKICAgIGFzeW5jIGxvYWRNb3ZpZXMoKSB7CiAgICAgIHRoaXMuaXNMb2FkaW5nLm1vdmllcyA9IHRydWU7CiAgICAgIGlmICh0aGlzLnBlcm1pc3Npb25zLmluY2x1ZGVzKCJsaXN0Om1vdmllcyIpKSB7CiAgICAgICAgY29uc29sZS5sb2coImNhbiBmZXRjaCBtb3ZpZXMiKTsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IEFwaVNlcnZpY2UuZ2V0SW5zdGFuY2UoKQogICAgICAgICAgLm1vdmllcygpCiAgICAgICAgICAuZ2V0QWxsKDEsICJieV9kYXRlIik7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN1Y2Nlc3MpIHsKICAgICAgICAgIHRoaXMubW92aWVEYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgIHRoaXMubW92aWVUb3RhbCA9IHJlc3BvbnNlLnRvdGFsOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmVycm9yLm1vdmllcyA9ICJGYWlsZWQgdG8gbG9hZCBtb3ZpZXMiOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnVuYXV0aG9yaXNlZCA9IHRydWU7CiAgICAgIH0KICAgICAgdGhpcy5pc0xvYWRpbmcubW92aWVzID0gZmFsc2U7CiAgICB9LAogIH0sCn07Cg=="},{"version":3,"sources":["Dashboard.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiOA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Dashboard.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <BasePage>\n    <template #main>\n      <div class=\"d-flex align-items-center py-4 border-bottom\">\n        <h3 class=\"mb-0 me-4\">Dashboard</h3>\n      </div>\n      <div class=\"mt-2\">\n        <div class=\"row mt-4\">\n          <div class=\"col-6\">\n            <router-link\n              :to=\"{ name: 'app_movies_list' }\"\n              class=\"d-block text-decoration-none text-black card-link\"\n            >\n              <div class=\"card rounded-3\">\n                <div class=\"card-body d-flex align-items-center px-4 py-4\">\n                  <div class=\"\">\n                    <h4 class=\"mb-3 d-flex align-items-center\">\n                      <i class=\"bi bi-camera-reels me-2\"></i> Manage movies\n                    </h4>\n                    <p class=\"text-secondary mb-0\">\n                      Current number of movies: {{ movieTotal }}\n                    </p>\n                  </div>\n                  <div class=\"d-flex ms-auto\">\n                    <i class=\"bi bi-arrow-right-circle fs-3\"></i>\n                  </div>\n                </div>\n              </div>\n            </router-link>\n          </div>\n          <div class=\"col-6\">\n            <router-link\n              :to=\"{ name: 'app_actors_list' }\"\n              class=\"d-block text-decoration-none text-black card-link\"\n            >\n              <div class=\"card rounded-3\">\n                <div class=\"card-body d-flex align-items-center px-4 py-4\">\n                  <div class=\"\">\n                    <h4 class=\"mb-3 d-flex align-items-center\">\n                      <i class=\"bi bi-people me-2\"></i> Manage actors\n                    </h4>\n                    <p class=\"text-secondary mb-0\">\n                      Current number of movies: {{ actorTotal }}\n                    </p>\n                  </div>\n                  <div class=\"d-flex ms-auto\">\n                    <i class=\"bi bi-arrow-right-circle fs-3\"></i>\n                  </div>\n                </div>\n              </div>\n            </router-link>\n          </div>\n        </div>\n        <div class=\"row mt-4 border-top pt-4\">\n          <div class=\"col-12 d-flex flex-wrap\">\n            <!--                Movies -->\n            <div class=\"p-3 w-50\">\n              <template v-if=\"isLoading.movies\">\n                <LoadingAnimation />\n              </template>\n              <template v-else-if=\"error.movies\">\n                <p>{{ error.movies }}</p>\n              </template>\n              <template v-else-if=\"!movieData\">\n                There are currently no actors in the system\n              </template>\n              <template v-else>\n                <div class=\"mt-3\">\n                  <h5>Upcoming Movies</h5>\n                </div>\n                <table class=\"table table-hover mt-3\">\n                  <thead class=\"bg-transparent\">\n                    <tr>\n                      <th scope=\"col\"></th>\n                      <th scope=\"col\">Title</th>\n                      <th scope=\"col\" class=\"text-center\">Release Date</th>\n                      <th scope=\"col\"></th>\n                    </tr>\n                  </thead>\n                  <tbody class=\"border table-light rounded-2 overflow-hidden\">\n                    <template v-for=\"movie in movieData\">\n                      <router-link\n                        tag=\"tr\"\n                        :to=\"{\n                          name: 'app_movies_view',\n                          params: { id: movie.id },\n                        }\"\n                        class=\"hoverable\"\n                        :key=\"movie.id\"\n                      >\n                        <td class=\"align-middle\">\n                          <template v-if=\"movie.image\">\n                            <img\n                              class=\"rounded\"\n                              style=\"\n                                object-fit: cover;\n                                width: 40px;\n                                height: 60px;\n                              \"\n                              :src=\"movie.image\"\n                              :alt=\"movie.title\"\n                            />\n                          </template>\n                          <template v-else>\n                            <i class=\"bi bi-film fs-4 ms-2\"></i>\n                          </template>\n                        </td>\n                        <td class=\"align-middle\">\n                          <router-link\n                            class=\"text-decoration-none text-black fw-bold\"\n                            :to=\"{\n                              name: 'app_movies_view',\n                              params: { id: movie.id },\n                            }\"\n                            >{{ movie.title }}\n                          </router-link>\n                        </td>\n                        <td class=\"text-center align-middle\">\n                          {{ movie.release_date }}\n                        </td>\n                        <td class=\"align-middle\">\n                          <router-link\n                            :to=\"{\n                              name: 'app_movies_view',\n                              params: { id: movie.id },\n                            }\"\n                            class=\"btn btn-sm btn-outline-secondary\"\n                            >View</router-link\n                          >\n                        </td>\n                      </router-link>\n                    </template>\n                  </tbody>\n                </table>\n              </template>\n            </div>\n            <!--                Actors-->\n            <div class=\"p-3 w-50\">\n              <template v-if=\"isLoading.actors\">\n                <LoadingAnimation />\n              </template>\n              <template v-else-if=\"error.actors\">\n                <p>{{ error.actors }}</p>\n              </template>\n              <template v-else-if=\"!actorData\">\n                There are currently no actors in the system\n              </template>\n              <template v-else>\n                <div class=\"mt-3\">\n                  <h5>Most Cast Actors</h5>\n                </div>\n                <table class=\"table table-hover mt-3\">\n                  <thead class=\"bg-transparent\">\n                    <tr>\n                      <th scope=\"col\"></th>\n                      <th scope=\"col\">Name</th>\n                      <th scope=\"col\" class=\"text-center\">Castings</th>\n                      <th scope=\"col\"></th>\n                    </tr>\n                  </thead>\n                  <tbody class=\"border table-light rounded-2 overflow-hidden\">\n                    <template v-for=\"actor in actorData\">\n                      <router-link\n                        tag=\"tr\"\n                        :to=\"{\n                          name: 'app_actors_view',\n                          params: { id: actor.id },\n                        }\"\n                        class=\"hoverable\"\n                        :key=\"actor.id\"\n                      >\n                        <td class=\"align-middle\">\n                          <template v-if=\"actor.image\">\n                            <img\n                              class=\"rounded-circle\"\n                              style=\"\n                                object-fit: cover;\n                                width: 40px;\n                                height: 40px;\n                              \"\n                              :src=\"actor.image\"\n                              :alt=\"actor.name\"\n                            />\n                          </template>\n                          <template v-else>\n                            <i class=\"bi bi-person-circle fs-4 ms-2\"></i>\n                          </template>\n                        </td>\n                        <td class=\"align-middle\">\n                          <router-link\n                            class=\"text-decoration-none text-black fw-bold\"\n                            :to=\"{\n                              name: 'app_actors_view',\n                              params: { id: actor.id },\n                            }\"\n                            >{{ actor.name }}</router-link\n                          >\n                        </td>\n                        <td class=\"text-center align-middle\">\n                          {{ actor.castings ? actor.castings.length : \"-\" }}\n                        </td>\n                        <td class=\"align-middle\">\n                          <router-link\n                            :to=\"{\n                              name: 'app_actors_view',\n                              params: { id: actor.id },\n                            }\"\n                            class=\"btn btn-sm btn-outline-secondary\"\n                            >View</router-link\n                          >\n                        </td>\n                      </router-link>\n                    </template>\n                  </tbody>\n                </table>\n              </template>\n            </div>\n          </div>\n        </div>\n      </div>\n    </template>\n  </BasePage>\n</template>\n\n<script>\nimport { BasePage } from \"@/components\";\nimport { LoadingAnimation } from \"@/components/shared\";\nimport { ApiService } from \"@/api\";\n\nexport default {\n  name: \"Dashboard\",\n  data() {\n    return {\n      movieData: null,\n      movieTotal: null,\n      actorData: null,\n      actorTotal: null,\n      isLoading: {\n        actors: true,\n        movies: true,\n      },\n      error: {\n        actors: null,\n        movies: null,\n      },\n      unauthorised: false,\n    };\n  },\n  components: {\n    BasePage,\n    LoadingAnimation,\n  },\n  created() {\n    this.loadActors();\n    this.loadMovies();\n  },\n  watch: {\n    authLoading(v) {\n      if (!v) {\n        this.loadMovies();\n        this.loadActors();\n      } else {\n        this.$router.push({ name: \"app_login\" });\n      }\n    },\n  },\n  computed: {\n    authLoading() {\n      return this.$auth.loading;\n    },\n    permissions() {\n      return this.$store.getters[\"getPermissions\"];\n    },\n  },\n  methods: {\n    async loadActors() {\n      this.isLoading.actors = true;\n      if (this.permissions.includes(\"list:actors\")) {\n        const response = await ApiService.getInstance()\n          .actors()\n          .getAll(1, \"by_castings\");\n        if (response.success) {\n          this.actorData = response.data;\n          this.actorTotal = response.total;\n        } else {\n          this.error.actors = \"Failed to load actors\";\n        }\n      } else {\n        this.unauthorised = true;\n      }\n      this.isLoading.actors = false;\n    },\n    async loadMovies() {\n      this.isLoading.movies = true;\n      if (this.permissions.includes(\"list:movies\")) {\n        console.log(\"can fetch movies\");\n        const response = await ApiService.getInstance()\n          .movies()\n          .getAll(1, \"by_date\");\n        if (response.success) {\n          this.movieData = response.data;\n          this.movieTotal = response.total;\n        } else {\n          this.error.movies = \"Failed to load movies\";\n        }\n      } else {\n        this.unauthorised = true;\n      }\n      this.isLoading.movies = false;\n    },\n  },\n};\n</script>\n"]}]}