{"remainingRequest":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/steven/workspace/casting-agency-frontend/src/components/movies/MovieList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/steven/workspace/casting-agency-frontend/src/components/movies/MovieList.vue","mtime":1654945191054},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js","mtime":1618407608009},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/babel-loader/lib/index.js","mtime":1650889791270},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1618407608009},{"path":"/home/steven/workspace/casting-agency-frontend/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1634219578329}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IEFwaVNlcnZpY2UgfSBmcm9tICJAL2FwaSI7CmltcG9ydCB7IExvYWRpbmdBbmltYXRpb24gfSBmcm9tICJAL2NvbXBvbmVudHMvc2hhcmVkIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJNb3ZpZUxpc3QiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBtb3ZpZURhdGE6IG51bGwsCiAgICAgIGlzTG9hZGluZzogdHJ1ZSwKICAgICAgZXJyb3I6IG51bGwsCiAgICAgIHVuYXV0aG9yaXNlZDogZmFsc2UsCiAgICAgIHBhZ2VzOiBudWxsLAogICAgICBwYWdlOiAxLAogICAgICBtb3ZpZVRvdGFsOiBudWxsLAogICAgfTsKICB9LAogIGNvbXBvbmVudHM6IHsKICAgIExvYWRpbmdBbmltYXRpb24sCiAgfSwKICB3YXRjaDogewogICAgYXV0aExvYWRpbmcodikgewogICAgICBpZiAoIXYpIHsKICAgICAgICB0aGlzLmxvYWRNb3ZpZXMoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICJhcHBfbG9naW4iIH0pOwogICAgICB9CiAgICB9LAogICAgcGFnZSgpIHsKICAgICAgY29uc29sZS5sb2coInBhZ2UgY2hhbmdlZCwgbG9hZCBtb3ZpZXMiKTsKICAgICAgdGhpcy5sb2FkTW92aWVzKCk7CiAgICB9LAogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGF1dGhMb2FkaW5nKCkgewogICAgICByZXR1cm4gdGhpcy4kYXV0aC5sb2FkaW5nOwogICAgfSwKICAgIHBlcm1pc3Npb25zKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVyc1siZ2V0UGVybWlzc2lvbnMiXTsKICAgIH0sCiAgICBwYWdlTnVtYmVycygpIHsKICAgICAgY29uc3QgcGFnZXMgPSBbXTsKICAgICAgbGV0IHBhZ2UgPSAwOwogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucGFnZXM7IGkrKykgewogICAgICAgIHBhZ2UrKzsKICAgICAgICBwYWdlcy5wdXNoKHBhZ2UpOwogICAgICAgIGNvbnNvbGUubG9nKHBhZ2VzKTsKICAgICAgfQogICAgICByZXR1cm4gcGFnZXM7CiAgICB9LAogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGlmICghdGhpcy5hdXRoTG9hZGluZykgewogICAgICBjb25zb2xlLmxvZygidXNlciIsIHRoaXMudXNlcik7CiAgICAgIHRoaXMubG9hZE1vdmllcygpOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgc2V0UGFnZShwYWdlKSB7CiAgICAgIHRoaXMucGFnZSA9IHBhZ2U7CiAgICAgIGNvbnNvbGUubG9nKCJwYWdlIiwgcGFnZSk7CiAgICB9LAogICAgYXN5bmMgbG9hZE1vdmllcygpIHsKICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlOwogICAgICBpZiAodGhpcy5wZXJtaXNzaW9ucy5pbmNsdWRlcygibGlzdDptb3ZpZXMiKSkgewogICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgQXBpU2VydmljZS5nZXRJbnN0YW5jZSgpCiAgICAgICAgICAubW92aWVzKCkKICAgICAgICAgIC5nZXRBbGwodGhpcy5wYWdlKTsKICAgICAgICBpZiAocmVzcG9uc2Uuc3VjY2VzcykgewogICAgICAgICAgdGhpcy5tb3ZpZURhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgdGhpcy5wYWdlcyA9IHJlc3BvbnNlLnBhZ2VzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmVycm9yID0gIkZhaWxlZCB0byBsb2FkIGFjdG9ycyI7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMudW5hdXRob3Jpc2VkID0gdHJ1ZTsKICAgICAgfQogICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["MovieList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MovieList.vue","sourceRoot":"src/components/movies","sourcesContent":["<template>\n  <div class=\"\">\n    <div class=\"d-flex align-items-center py-4 border-bottom\">\n      <h3 class=\"mb-0 me-4\">Movies</h3>\n      <router-link\n        v-if=\"permissions.includes('add:movie')\"\n        tag=\"button\"\n        :to=\"{ name: 'app_movies_new' }\"\n        class=\"btn btn-primary ms-auto\"\n      >\n        <i class=\"bi bi-plus-circle me-1\"></i>\n        <span>Add Movie</span>\n      </router-link>\n    </div>\n\n    <div class=\"mt-2\">\n      <template v-if=\"isLoading\">\n        <LoadingAnimation />\n      </template>\n      <template v-else-if=\"unauthorised\">\n        <p>You do not have permission to view Movies</p>\n      </template>\n      <template v-else-if=\"error\">\n        <p>{{ error }}</p>\n      </template>\n      <template v-else-if=\"!movieData.length\">\n        <p>Could not find any movies.</p>\n      </template>\n      <template v-else>\n        <div class=\"row d-flex px-2 py-3 movie-row align-items-stretch\">\n          <template v-for=\"movie in movieData\">\n            <router-link\n              class=\"movie-card text-decoration-none text-black p-0\"\n              :key=\"movie.id\"\n              :to=\"{ name: 'app_movies_view', params: { id: movie.id } }\"\n            >\n              <div class=\"card shadow-sm p-0\">\n                <div\n                  class=\"card-body movie-card-picture\"\n                  :style=\"{\n                    background: movie.image\n                      ? `url(${movie.image})`\n                      : `url('https://via.placeholder.com/300x250')`,\n                  }\"\n                >\n                  <span class=\"movie-card-link\">\n                    <router-link\n                      v-if=\"permissions.includes('edit:movie')\"\n                      class=\"btn-secondary btn btn-sm py-1 px-3\"\n                      :key=\"movie.id\"\n                      :to=\"{\n                        name: 'app_movies_edit',\n                        params: { id: movie.id },\n                      }\"\n                    >\n                      Edit\n                    </router-link>\n                  </span>\n                  <span class=\"movie-card-link center\">\n                    <button class=\"btn btn-light\">View</button>\n                  </span>\n                </div>\n                <div class=\"card-footer\">\n                  <div class=\"d-flex\">\n                    <h4\n                      class=\"fw-bold movie-title fs-5 text-black text-decoration-none\"\n                    >\n                      {{ movie.title }}\n                    </h4>\n                    <p class=\"ms-auto text-secondary\">\n                      <i class=\"bi bi-people-fill\"></i>\n                      {{ movie.cast ? movie.cast.length : 0 }}\n                    </p>\n                  </div>\n                  <div>\n                    <span class=\"text-secondary fst-italic\">\n                      Releasing:\n                      <span>{{ movie.release_date }}</span>\n                    </span>\n                  </div>\n                </div>\n              </div>\n            </router-link>\n          </template>\n        </div>\n        <div>\n          <nav aria-label=\"Page Navigation\" class=\"mt-4\">\n            <ul class=\"pagination\">\n              <li class=\"page-item\">\n                <a\n                  class=\"page-link\"\n                  @click=\"setPage(page - 1)\"\n                  :class=\"{ disabled: page <= 1 }\"\n                  href=\"#\"\n                  aria-label=\"Previous\"\n                >\n                  <span aria-hidden=\"true\">\n                    <i class=\"bi bi-arrow-left\"></i>\n                  </span>\n                </a>\n              </li>\n              <template v-for=\"(pageNumber, index) in pageNumbers\">\n                <li :key=\"index\" class=\"page-item\">\n                  <a\n                    @click=\"setPage(pageNumber)\"\n                    class=\"page-link\"\n                    :class=\"{ active: page === pageNumber }\"\n                    href=\"#\"\n                  >\n                    {{ pageNumber }}\n                  </a>\n                </li>\n              </template>\n              <li class=\"page-item\">\n                <a\n                  class=\"page-link\"\n                  @click=\"setPage(page + 1)\"\n                  :class=\"{ disabled: page >= pages }\"\n                  href=\"#\"\n                  aria-label=\"Next\"\n                >\n                  <span aria-hidden=\"true\">\n                    <i class=\"bi bi-arrow-right\"></i>\n                  </span>\n                </a>\n              </li>\n            </ul>\n          </nav>\n        </div>\n      </template>\n    </div>\n  </div>\n</template>\n<script>\nimport { ApiService } from \"@/api\";\nimport { LoadingAnimation } from \"@/components/shared\";\nexport default {\n  name: \"MovieList\",\n  data() {\n    return {\n      movieData: null,\n      isLoading: true,\n      error: null,\n      unauthorised: false,\n      pages: null,\n      page: 1,\n      movieTotal: null,\n    };\n  },\n  components: {\n    LoadingAnimation,\n  },\n  watch: {\n    authLoading(v) {\n      if (!v) {\n        this.loadMovies();\n      } else {\n        this.$router.push({ name: \"app_login\" });\n      }\n    },\n    page() {\n      console.log(\"page changed, load movies\");\n      this.loadMovies();\n    },\n  },\n  computed: {\n    authLoading() {\n      return this.$auth.loading;\n    },\n    permissions() {\n      return this.$store.getters[\"getPermissions\"];\n    },\n    pageNumbers() {\n      const pages = [];\n      let page = 0;\n      for (let i = 0; i < this.pages; i++) {\n        page++;\n        pages.push(page);\n        console.log(pages);\n      }\n      return pages;\n    },\n  },\n  created() {\n    if (!this.authLoading) {\n      console.log(\"user\", this.user);\n      this.loadMovies();\n    }\n  },\n  methods: {\n    setPage(page) {\n      this.page = page;\n      console.log(\"page\", page);\n    },\n    async loadMovies() {\n      this.isLoading = true;\n      if (this.permissions.includes(\"list:movies\")) {\n        const response = await ApiService.getInstance()\n          .movies()\n          .getAll(this.page);\n        if (response.success) {\n          this.movieData = response.data;\n          this.pages = response.pages;\n        } else {\n          this.error = \"Failed to load actors\";\n        }\n      } else {\n        this.unauthorised = true;\n      }\n      this.isLoading = false;\n    },\n  },\n};\n</script>\n"]}]}